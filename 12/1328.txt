  (a) As soon as practicable after completion by the debtor of all payments under the plan, unless the court approves a written waiver of discharge executed by the debtor after the order for relief under this chapter, the court shall grant the debtor a discharge of all debts provided for by the plan or disallowed under section 502 of this title, except any debt–
    (1) provided for under section 1322(b)(5) of this title;
    (2) of the kind specified in paragraph (5), (8), or (9) of section 523(a) of this title; or
    (3) for restitution, or a criminal fine, included in a sentence on the debtor“s conviction of a crime.
  (b) At any time after the confirmation of the plan and after notice and a hearing, the court may grant a discharge to a debtor that has not completed payments under the plan only if–
    (1) the debtor“s failure to complete such payments is due to circumstances for which the debtor should not justly be held accountable;
    (2) the value, as of the effective date of the plan, of property actually distributed under the plan on account of each allowed unsecured claim is not less than the amount that would have been paid on such claim if the estate of the debtor had been liquidated under chapter 7 of this title on such date; and
    (3) modification of the plan under section 1329 of this title is not practicable.
  (c) A discharge granted under subsection (b) of this section discharges the debtor from all unsecured debts provided for by the plan or disallowed under section 502 of this title, except any debt–
    (1) provided for under section 1322(b)(5) of this title; or
    (2) of a kind specified in section 523(a) of this title.
  (d) Notwithstanding any other provision of this section, a discharge granted under this section does not discharge the debtor from any debt based on an allowed claim filed under section 1305(a)(2) of this title if prior approval by the trustee of the debtor“s incurring such debt was practicable and was not obtained.
  (e) On request of a party in interest before one year after a discharge under this section is granted, and after notice and a hearing, the court may revoke such discharge only if–
    (1) such discharge was obtained by the debtor through fraud; and
    (2) the requesting party did not know of such fraud until after such discharge was granted.
