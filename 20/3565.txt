  (a) T4Continuation or RevocationK.–If the defendant violates a condition of probation at any time prior to the expiration or termination of the term of probation, the court may, after a hearing pursuant to Rule 32.1 of the Federal Rules of Criminal Procedure, and after considering the factors set forth in section 3553(a) to the extent that they are applicable–
    (1) continue him on probation, with or without extending the term or modifying or enlarging the conditions; or
    (2) revoke the sentence of probation and resentence the defendant under subchapter A.
  (b) T4Mandatory Revocation for Possession of Controlled Substance or Firearm or Refusal To Comply With Drug TestingK.–If the defendant–
    (1) possesses a controlled substance in violation of the condition set forth in section 3563(a)(3);
    (2) possesses a firearm, as such term is defined in section 921 of this title, in violation of Federal law, or otherwise violates a condition of probation prohibiting the defendant from possessing a firearm; or
    (3) refuses to comply with drug testing, thereby violating the condition imposed by section 3563(a)(4),\1\N
       the court shall revoke the sentence of probation and resentence the defendant under subchapter A to a sentence that includes a term of imprisonment.
  (c) T4Delayed RevocationK.–The power of the court to revoke a sentence of probation for violation of a condition of probation, and to impose another sentence, extends beyond the expiration of the term of probation for any period reasonably necessary for the adjudication of matters arising before its expiration if, prior to its expiration, a warrant or summons has been issued on the basis of an allegation of such a violation.
