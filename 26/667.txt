  (a) General rule
     The total of the amounts which are treated under section 666 as having been distributed by a trust in a preceding taxable year shall be included in the income of a beneficiary of the trust when paid, credited, or required to be distributed to the extent that such total would have been included in the income of such beneficiary under section 662(a)(2) (and, with respect to any tax-exempt interest to which section 103 applies, under section 662(b)) if such total had been paid to such beneficiary on the last day of such preceding taxable year. The tax imposed by this subtitle on a beneficiary for a taxable year in which any such amount is included in his income shall be determined only as provided in this section and shall consist of the sum of–
    (1) a partial tax computed on the taxable income reduced by an amount equal to the total of such amounts, at the rate and in the manner as if this section had not been enacted,
    (2) a partial tax determined as provided in subsection (b) of this section, and
    (3) in the case of a foreign trust, the interest charge determined as provided in section 668.
  (b) Tax on distribution
    (1) In general
       The partial tax imposed by subsection (a)(2) shall be determined.
      (A) by determining the number of preceding taxable years of the trust on the last day of which an amount is deemed under section 666(a) to have been distributed,
      (B) by taking from the 5 taxable years immediately preceding the year of the accumulation distribution the 1 taxable year for which the beneficiary“s taxable income was the highest and the 1 taxable year for which his taxable income was the lowest,
      (C) by adding to the beneficiary“s taxable income for each of the 3 taxable years remaining after the application of subparagraph (B) an amount determined by dividing the amount deemed distributed under section 666 and required to be included in income under subsection (a) by the number of preceding taxable years determined under subparagraph (A), and
      (D) by determining the average increase in tax for the 3 taxable years referred to in subparagraph (C) resulting from the application of such subparagraph.
       The partial tax imposed by subsection (a)(2) shall be the excess (if any) of the average increase in tax determined under subparagraph (D), multiplied by the number of preceding taxable years determined under subparagraph (A), over the amount of taxes (other than the amount of taxes described in section 665(d)(2)) deemed distributed to the beneficiary under sections 666(b) and (c).
    (2) Treatment of loss years
       For purposes of paragraph (1), the taxable income of the beneficiary for any taxable year shall be deemed to be not less than zero.
    (3) Certain preceding taxable years not taken into account
       For purposes of paragraph (1), if the amount of the undistributed net income deemed distributed in any preceding taxable year of the trust is less than 25 percent of the amount of the accumulation distribution divided by the number of preceding taxable years to which the accumulation distribution is allocated under section 666(a), the number of preceding taxable years of the trust with respect to which an amount is deemed distributed to a beneficiary under section 666(a) shall be determined without regard to such year.
    (4) Effect of other accumulation distributions
       In computing the partial tax under paragraph (1) for any beneficiary, the income of such beneficiary for each of his prior taxable years shall include amounts previously deemed distributed to such beneficiary in such year under section 666 as a result of prior accumulation distributions (whether from the same or another trust).
    (5) Multiple distributions in the same taxable year
       In the case of accumulation distributions made from more than one trust which are includible in the income of a beneficiary in the same taxable year, the distributions shall be deemed to have been made consecutively in whichever order the beneficiary shall determine.
    (6) Adjustment in partial tax for estate and generation-skipping transfer taxes attributable to partial tax
      (A) In general
         The partial tax shall be reduced by an amount which is equal to the pre-death portion of the partial tax multiplied by a fraction–
        (i) the numerator of which is that portion of the tax imposed by chapter 11 or 13, as the case may be, which is attributable (on a proportionate basis) to amounts included in the accumulation distribution, and
        (ii) the denominator of which is the amount of the accumulation distribution which is subject to the tax imposed by chapter 11 or 13, as the case may be.
      (B) Partial tax determined without regard to this paragraph
         For purposes of this paragraph, the term ””partial tax““ means the partial tax imposed by subsection (a)(2) determined under this subsection without regard to this paragraph.
      (C) Pre-death portion
         For purposes of this paragraph, the pre-death portion of the partial tax shall be an amount which bears the same ratio to the partial tax as the portion of the accumulation distribution which is attributable to the period before the date of the death of the decedent or the date of the generation-skipping transfer bears to the total accumulation distribution.
  (c) Special rule for multiple trusts
    (1) In general
       If, in the same prior taxable year of the beneficiary in which any part of the accumulation distribution from a trust (hereinafter in this paragraph referred to as ””third trust““) is deemed under section 666(a) to have been distributed to such beneficiary, some part of prior distributions by each of 2 or more other trusts is deemed under section 666(a) to have been distributed to such beneficiary, then subsections (b) and (c) of section 666 shall not apply with respect to such part of the accumulation distribution from such third trust.
    (2) Accumulation distributions from trust not taken into account unless they equal or exceed $1,000
       For purposes of paragraph (1), an accumulation distribution from a trust to a beneficiary shall be taken into account only if such distribution, when added to any prior accumulation distributions from such trust which are deemed under section 666(a) to have been distributed to such beneficiary for the same prior taxable year of the beneficiary, equals or exceeds $1,000.
  (d) Special rules for foreign trust
    (1) Foreign tax deemed paid by beneficiary
      (A) In general
         In determining the increase in tax under subsection (b)(1)(D) for any computation year, the taxes described in section 665(d)(2) which are deemed distributed under section 666(b) or (c) and added under subsection (b)(1)(C) to the taxable income of the beneficiary for any computation year shall, except as provided in subparagraphs (B) and (C), be treated as a credit against the increase in tax for such computation year under subsection (b)(1)(D).
      (B) Deduction in lieu of credit
         If the beneficiary did not choose the benefits of subpart A of part III of subchapter N with respect to the computation year, the beneficiary may in lieu of treating the amounts described in subparagraph (A) (without regard to subparagraph (C)) as a credit may treat such amounts as a deduction in computing the beneficiary“s taxable income under subsection (b)(1)(C) for the computation year.
      (C) Limitation on credit; retention of character
        (i) Limitation on credit
           For purposes of determining under subparagraph (A) the amount treated as a credit for any computation year, the limitations under subpart A of part III of subchapter N shall be applied separately with respect to amounts added under subsection (b)(1)(C) to the taxable income of the beneficiary for such computation year. For purposes of computing the increase in tax under subsection (b)(1)(D) for any computation year for which the beneficiary did not choose the benefits of subpart A of part III of subchapter N, the beneficiary shall be treated as having chosen such benefits for such computation year.
        (ii) Retention of character
           The items of income, deduction, and credit of the Trust shall retain their character (subject to the application of section 904(f)(5)) to the extent necessary to apply this paragraph.
      (D) Computation year
         For purposes of this paragraph, the term ””computation year““ means any of the three taxable years remaining after application of subsection (b)(1)(B).
  (e) Retention of character of amounts distributed from accumulation trust to nonresident aliens and foreign corporations
     In the case of a distribution from a trust to a nonresident alien individual or to a foreign corporation, the first sentence of subsection (a) shall be applied as if the reference to the determination of character under section 662(b) applied to all amounts instead of just to tax-exempt interest.
