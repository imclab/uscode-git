  (a) General rule
     For purposes of this title–
    (1) except as provided in subsection (b), no summons may be issued under this title, and the Secretary may not begin any action under section 7604 to enforce any summons to produce or analyze any tax-related computer software source code; and
    (2) any software and related materials which are provided to the Secretary under this title shall be subject to the safeguards under subsection (c).
  (b) Circumstances under which computer software source code may be provided
    (1) In general
       Subsection (a)(1) shall not apply to any portion, item, or component of tax-related computer software source code if–
      (A) the Secretary is unable to otherwise reasonably ascertain the correctness of any item on a return from–
        (i) the taxpayer“s books, papers, records, or other data; or
        (ii) the computer software executable code (and any modifications thereof) to which such source code relates and any associated data which, when executed, produces the output to ascertain the correctness of the item;
      (B) the Secretary identifies with reasonable specificity the portion, item, or component of such source code needed to verify the correctness of such item on the return; and
      (C) the Secretary determines that the need for the portion, item, or component of such source code with respect to such item outweighs the risks of unauthorized disclosure of trade secrets.
    (2) Exceptions
       Subsection (a)(1) shall not apply to–
      (A) any inquiry into any offense connected with the administration or enforcement of the internal revenue laws;
      (B) any tax-related computer software source code acquired or developed by the taxpayer or a related person primarily for internal use by the taxpayer or such person rather than for commercial distribution;
      (C) any communications between the owner of the tax-related computer software source code and the taxpayer or related persons; or
      (D) any tax-related computer software source code which is required to be provided or made available pursuant to any other provision of this title.
    (3) Cooperation required
       For purposes of paragraph (1), the Secretary shall be treated as meeting the requirements of subparagraphs (A) and (B) of such paragraph if–
      (A) the Secretary determines that it is not feasible to determine the correctness of an item without access to the computer software executable code and associated data described in paragraph (1)(A)(ii);
      (B) the Secretary makes a formal request to the taxpayer for such code and data and to the owner of the computer software source code for such executable code; and
      (C) such code and data is not provided within 180 days of such request.
    (4) Right to contest summons
       In any proceeding brought under section 7604 to enforce a summons issued under the authority of this subsection, the court shall, at the request of any party, hold a hearing to determine whether the applicable requirements of this subsection have been met.
  (c) Safeguards to ensure protection of trade secrets and other confidential information
    (1) Entry of protective order
       In any court proceeding to enforce a summons for any portion of software, the court may receive evidence and issue any order necessary to prevent the disclosure of trade secrets or other confidential information with respect to such software, including requiring that any information be placed under seal to be opened only as directed by the court.
    (2) Protection of software
       Notwithstanding any other provision of this section, and in addition to any protections ordered pursuant to paragraph (1), in the case of software that comes into the possession or control of the Secretary in the course of any examination with respect to any taxpayer–
      (A) the software may be used only in connection with the examination of such taxpayer“s return, any appeal by the taxpayer to the Internal Revenue Service Office of Appeals, any judicial proceeding (and any appeals therefrom), and any inquiry into any offense connected with the administration or enforcement of the internal revenue laws;
      (B) the Secretary shall provide, in advance, to the taxpayer and the owner of the software a written list of the names of all individuals who will analyze or otherwise have access to the software;
      (C) the software shall be maintained in a secure area or place, and, in the case of computer software source code, shall not be removed from the owner“s place of business unless the owner permits, or a court orders, such removal;
      (D) the software may not be copied except as necessary to perform such analysis, and the Secretary shall number all copies made and certify in writing that no other copies have been (or will be) made;
      (E) at the end of the period during which the software may be used under subparagraph (A)–
        (i) the software and all copies thereof shall be returned to the person from whom they were obtained and any copies thereof made under subparagraph (D) on the hard drive of a machine or other mass storage device shall be permanently deleted; and
        (ii) the Secretary shall obtain from any person who analyzes or otherwise had access to such software a written certification under penalty of perjury that all copies and related materials have been returned and that no copies were made of them;
      (F) the software may not be decompiled or disassembled;
      (G) the Secretary shall provide to the taxpayer and the owner of any interest in such software, as the case may be, a written agreement, between the Secretary and any person who is not an officer or employee of the United States and who will analyze or otherwise have access to such software, which provides that such person agrees not to–
        (i) disclose such software to any person other than persons to whom such information could be disclosed for tax administration purposes under section 6103; or
        (ii) participate for 2 years in the development of software which is intended for a similar purpose as the software examined; and
      (H) the software shall be treated as return information for purposes of section 6103.
       For purposes of subparagraph (C), the owner shall make available any necessary equipment or materials for analysis of computer software source code required to be conducted on the owner“s premises. The owner of any interest in the software shall be considered a party to any agreement described in subparagraph (G).
  (d) Definitions
     For purposes of this section–
    (1) Software
       The term ””software““ includes computer software source code and computer software executable code.
    (2) Computer software source code
       The term ””computer software source code““ means–
      (A) the code written by a programmer using a programming language which is comprehensible to appropriately trained persons and is not capable of directly being used to give instructions to a computer;
      (B) related programmers“ notes, design documents, memoranda, and similar documentation; and
      (C) related customer communications.
    (3) Computer software executable code
       The term ””computer software executable code““ means–
      (A) any object code, machine code, or other code readable by a computer when loaded into its memory and used directly by such computer to execute instructions; and
      (B) any related user manuals.
    (4) Owner
       The term ””owner““ shall, with respect to any software, include the developer of the software.
    (5) Related person
       A person shall be treated as related to another person if such persons are related persons under section 267 or 707(b).
    (6) Tax-related computer software source code
       The term ””tax-related computer software source code““ means the computer source code for any computer software program intended for accounting, tax return preparation or compliance, or tax planning.
