  (a) General rule
     Except as otherwise provided in this section, in the case of a–
    (1) C corporation,
    (2) partnership which has a C corporation as a partner, or
    (3) tax shelter,
       taxable income shall not be computed under the cash receipts and disbursements method of accounting.
  (b) Exceptions
    (1) Farming business
       Paragraphs (1) and (2) of subsection (a) shall not apply to any farming business.
    (2) Qualified personal service corporations
       Paragraphs (1) and (2) of subsection (a) shall not apply to a qualified personal service corporation, and such a corporation shall be treated as an individual for purposes of determining whether paragraph (2) of subsection (a) applies to any partnership.
    (3) Entities with gross receipts of not more than $5,000,000
       Paragraphs (1) and (2) of subsection (a) shall not apply to any corporation or partnership for any taxable year if, for all prior taxable years beginning after December 31, 1985, such entity (or any predecessor) met the $5,000,000 gross receipts test of subsection (c).
  (c) $5,000,000 gross receipts test
     For purposes of this section–
    (1) In general
       A corporation or partnership meets the $5,000,000 gross receipts test of this subsection for any prior taxable year if the average annual gross receipts of such entity for the 3-taxable-year period ending with such prior taxable year does not exceed $5,000,000.
    (2) Aggregation rules
       All persons treated as a single employer under subsection (a) or (b) of section 52 or subsection (m) or (T3oK) of section 414 shall be treated as one person for purposes of paragraph (1).
    (3) Special rules
       For purposes of this subsection–
      (A) Not in existence for entire 3-year period
         If the entity was not in existence for the entire 3-year period referred to in paragraph (1), such paragraph shall be applied on the basis of the period during which such entity (or trade or business) was in existence.
      (B) Short taxable years
         Gross receipts for any taxable year of less than 12 months shall be annualized by multiplying the gross receipts for the short period by 12 and dividing the result by the number of months in the short period.
      (C) Gross receipts
         Gross receipts for any taxable year shall be reduced by returns and allowances made during such year.
      (D) Treatment of predecessors
         Any reference in this subsection to an entity shall include a reference to any predecessor of such entity.
  (d) Definitions and special rules
     For purposes of this section–
    (1) Farming business
      (A) In general
         The term ””farming business““ means the trade or business of farming (within the meaning of section 263A(e)(4)).
      (B) Timber and ornamental trees
         The term ””farming business““ includes the raising, harvesting, or growing of trees to which section 263A(c)(5) applies.
    (2) Qualified personal service corporation
       The term ””qualified personal service corporation““ means any corporation–
      (A) substantially all of the activities of which involve the performance of services in the fields of health, law, engineering, architecture, accounting, actuarial science, performing arts, or consulting, and
      (B) substantially all of the stock of which (by value) is held directly (or indirectly through 1 or more partnerships, S corporations, or qualified personal service corporations not described in paragraph (2) or (3) of subsection (a)) by–
        (i) employees performing services for such corporation in connection with the activities involving a field referred to in subparagraph (A),
        (ii) retired employees who had performed such services for such corporation,
        (iii) the estate of any individual described in clause (i) or (ii), or
        (iv) any other person who acquired such stock by reason of the death of an individual described in clause (i) or (ii) (but only for the 2-year period beginning on the date of the death of such individual).
       To the extent provided in regulations which shall be prescribed by the Secretary, indirect holdings through a trust shall be taken into account under subparagraph (B).
    (3) Tax shelter defined
       The term ””tax shelter““ has the meaning given such term by section 461(i)(3) (determined after application of paragraph (4) thereof). An S corporation shall not be treated as a tax shelter for purposes of this section merely by reason of being required to file a notice of exemption from registration with a State agency described in section 461(i)(3)(A), but only if there is a requirement applicable to all corporations offering securities for sale in the State that to be exempt from such registration the corporation must file such a notice.
    (4) Special rules for application of paragraph (2)
       For purposes of paragraph (2)–
      (A) community property laws shall be disregarded,
      (B) stock held by a plan described in section 401(a) which is exempt from tax under section 501(a) shall be treated as held by an employee described in paragraph (2)(B)(i), and
      (C) at the election of the common parent of an affiliated group (within the meaning of section 1504(a)), all members of such group may be treated as 1 taxpayer for purposes of paragraph (2)(B) if 90 percent or more of the activities of such group involve the performance of services in the same field described in paragraph (2)(A).
    (5) Special rule for certain services
      (A) In general
         In the case of any person using an accrual method of accounting with respect to amounts to be received for the performance of services by such person, such person shall not be required to accrue any portion of such amounts which (on the basis of such person“s experience) will not be collected if–
        (i) such services are in fields referred to in paragraph (2)(A), or
        (ii) such person meets the gross receipts test of subsection (c) for all prior taxable years.
      (B) Exception
         This paragraph shall not apply to any amount if interest is required to be paid on such amount or there is any penalty for failure to timely pay such amount.
      (C) Regulations
         The Secretary shall prescribe regulations to permit taxpayers to determine amounts referred to in subparagraph (A) using computations or formulas which, based on experience, accurately reflect the amount of income that will not be collected by such person. A taxpayer may adopt, or request consent of the Secretary to change to, a computation or formula that clearly reflects the taxpayer“s experience. A request under the preceding sentence shall be approved if such computation or formula clearly reflects the taxpayer“s experience.
    (6) Treatment of certain trusts subject to tax on unrelated business income
       For purposes of this section, a trust subject to tax under section 511(b) shall be treated as a C corporation with respect to its activities constituting an unrelated trade or business.
    (7) Coordination with section 481
       In the case of any taxpayer required by this section to change its method of accounting for any taxable year–
      (A) such change shall be treated as initiated by the taxpayer,
      (B) such change shall be treated as made with the consent of the Secretary, and
      (C) the period for taking into account the adjustments under section 481 by reason of such change–
        (i) except as provided in clause (ii), shall not exceed 4 years, and
        (ii) in the case of a hospital, shall be 10 years.
    (8) Use of related parties, etc.
       The Secretary shall prescribe such regulations as may be necessary to prevent the use of related parties, pass-thru entities, or intermediaries to avoid the application of this section.
